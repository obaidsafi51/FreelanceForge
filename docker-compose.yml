services:
  substrate-node:
    build:
      context: ./substrate-node
      dockerfile: Dockerfile
    ports:
      - "9944:9944" # WebSocket port
      - "9933:9933" # HTTP RPC port
      - "30333:30333" # P2P port
    command:
      [
        "./target/release/minimal-template-node",
        "--dev",
        "--ws-external",
        "--rpc-external",
        "--rpc-cors",
        "all",
        "--rpc-methods",
        "unsafe",
      ]
    volumes:
      - substrate_data:/data
    environment:
      - RUST_LOG=debug

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
    environment:
      - REACT_APP_WS_PROVIDER=ws://localhost:9944
      - REACT_APP_NETWORK=local
    depends_on:
      - substrate-node
    volumes:
      - ./frontend:/app
      - /app/node_modules

volumes:
  substrate_data:
